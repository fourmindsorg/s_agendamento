=================================================
üîç DIAGN√ìSTICO COMPLETO
=================================================

Execute no servidor para diagn√≥stico:

1Ô∏è‚É£ VER √öLTIMO COMMIT NO SERVIDOR (se tem Git):
--------------------------------------
cd /home/ubuntu/s_agendamento
git log --oneline -5

2Ô∏è‚É£ VER DATA DOS ARQUIVOS EM PRODU√á√ÉO:
--------------------------------------
ls -lth /opt/s-agendamento/agendamentos/templates/agendamentos/home.html

3Ô∏è‚É£ COMPARAR DATA DO SISTEMA:
--------------------------------------
stat /opt/s-agendamento/manage.py
stat /home/ubuntu/s_agendamento/manage.py

4Ô∏è‚É£ VER QUANDO FOI MODIFICADO:
--------------------------------------
find /opt/s-agendamento -type f -name "*.py" -exec stat -c "%y %n" {} \; | sort | tail -20

5Ô∏è‚É£ VER SE VENV EST√Å ATIVO E QUAL PYTHON:
--------------------------------------
which python
python --version
which pip
pip list | grep Django

6Ô∏è‚É£ VER ESTRUTURA DO C√ìDIGO:
--------------------------------------
ls -la /opt/s-agendamento/
ls -la /opt/s-agendamento/agendamentos/
ls -la /opt/s-agendamento/agendamentos/templates/

7Ô∏è‚É£ VER √öLTIMOS ARQUIVOS MODIFICADOS:
--------------------------------------
find /opt/s-agendamento -type f -mtime -7 -ls


=================================================
üéØ AN√ÅLISE
=================================================

Poss√≠veis causas:

1. Arquivos n√£o foram copiados de fato
2. Cache do navegador mostrando vers√£o antiga
3. Supervisor/Gunicorn est√° rodando c√≥digo antigo em mem√≥ria
4. Permiss√µes impedindo atualiza√ß√£o
5. Servidor n√£o reiniciou corretamente

=================================================
‚úÖ SOLU√á√ÉO DEFINITIVA
=================================================

Execute TUDO na ordem:

# 1. PARAR COMPLETAMENTE O SISTEMA
sudo supervisorctl stop s-agendamento
sudo pkill -f gunicorn

# 2. REMOVER C√ìDIGO ANTIGO
cd /opt
sudo rm -rf s-agendamento/agendamentos
sudo rm -rf s-agendamento/authentication
sudo rm -rf s-agendamento/core
sudo rm -rf s-agendamento/financeiro
sudo rm -rf s-agendamento/info
sudo rm -rf s-agendamento/templates
sudo rm -f s-agendamento/manage.py
sudo rm -f s-agendamento/requirements.txt

# 3. COPIAR C√ìDIGO NOVO (COMPLETO)
sudo cp -r /home/ubuntu/s_agendamento/agendamentos /opt/s-agendamento/
sudo cp -r /home/ubuntu/s_agendamento/authentication /opt/s-agendamento/
sudo cp -r /home/ubuntu/s_agendamento/core /opt/s-agendamento/
sudo cp -r /home/ubuntu/s_agendamento/financeiro /opt/s-agendamento/
sudo cp -r /home/ubuntu/s_agendamento/info /opt/s-agendamento/
sudo cp -r /home/ubuntu/s_agendamento/templates /opt/s-agendamento/
sudo cp /home/ubuntu/s_agendamento/manage.py /opt/s-agendamento/
sudo cp /home/ubuntu/s_agendamento/requirements.txt /opt/s-agendamento/

# 4. VERIFICAR SE ARQUIVOS FORAM COPIADOS
ls -lth /opt/s-agendamento/agendamentos/templates/agendamentos/home.html
# ^ Esse arquivo deve mostrar data RECENTE

# 5. GARANTIR PERMISS√ïES
sudo chown -R django:www-data /opt/s-agendamento
sudo chmod -R 755 /opt/s-agendamento

# 6. ATUALIZAR DEPEND√äNCIAS
cd /opt/s-agendamento
source venv/bin/activate
pip install -r requirements.txt --upgrade --quiet

# 7. RODAR MIGRA√á√ïES
python manage.py migrate

# 8. COLETAR STATIC
python manage.py collectstatic --noinput

# 9. LIMPAR CACHE PYTHON
find . -type d -name __pycache__ -exec rm -r {} + 2>/dev/null

# 10. REINICIAR TUDO
sudo supervisorctl start s-agendamento
sudo systemctl restart nginx

# 11. AGUARDAR
sleep 10

# 12. TESTAR
curl -I http://localhost


=================================================
üîê SE N√ÉO FUNCIONAR, DEBUG:
=================================================

# Ver processos rodando
ps aux | grep python

# Ver qual c√≥digo est√° sendo carregado
sudo supervisorctl tail -f s-agendamento

# Ver logs
sudo tail -f /opt/s-agendamento/logs/gunicorn.log

# Testar Django diretamente
cd /opt/s-agendamento
source venv/bin/activate
python manage.py check


=================================================
üåê TESTE NO NAVEGADOR:
=================================================

1. Abra em MODO AN√îNIMO/PRIVADO
2. Ou limpe cache: Ctrl+Shift+Delete
3. Ou Force Refresh: Ctrl+F5
4. Acesse: https://fourmindstech.com.br/s_agendamentos/


=================================================

